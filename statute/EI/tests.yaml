# Employment Insurance Act - EI Benefits Tests
#
# Test cases for validating Employment Insurance calculations.
# Uses 2024 rates and amounts.
#
# 2024 EI Amounts:
# - Maximum insurable earnings: $63,200
# - Premium rate (employee): 1.66%
# - Premium rate (employer): 1.66% * 1.4 = 2.324%
# - Maximum employee premium: $1,049.12
# - Benefit rate: 55% of average insurable earnings
# - Maximum weekly benefit: $668
# - Quebec has separate QPIP system with different rates
#
# Reference: https://www.canada.ca/en/services/benefits/ei.html

reference: "Employment Insurance Act"
year: 2024

tests:
  # ==========================================================================
  # EI PREMIUM TESTS
  # ==========================================================================

  # Test 1: Low income employee premium
  - name: "Low income, employee premium"
    inputs:
      insurable_earnings: 30000
      province: ON
    expected:
      # $30,000 * 1.66% = $498
      ei_employee_premium: 498
    notes: "Below maximum insurable earnings"

  # Test 2: Maximum premium (at ceiling)
  - name: "High income, capped at maximum"
    inputs:
      insurable_earnings: 80000
      province: ON
    expected:
      # Capped at $63,200 * 1.66% = $1,049.12
      ei_employee_premium: 1049.12
    notes: "Capped at maximum insurable earnings"

  # Test 3: At exactly maximum insurable earnings
  - name: "At maximum insurable earnings"
    inputs:
      insurable_earnings: 63200
      province: ON
    expected:
      ei_employee_premium: 1049.12
    notes: "Exactly at MIE threshold"

  # Test 4: Quebec resident (reduced EI rate due to QPIP)
  - name: "Quebec resident, reduced rate"
    inputs:
      insurable_earnings: 50000
      province: QC
    expected:
      # Quebec EI rate: 1.32% (lower because QPIP covers parental)
      # $50,000 * 1.32% = $660
      ei_employee_premium: 660
    notes: "Quebec has lower EI rate due to QPIP"

  # Test 5: Employer premium
  - name: "Employer premium calculation"
    inputs:
      insurable_earnings: 50000
      province: ON
    expected:
      # Employee: $50,000 * 1.66% = $830
      # Employer: $830 * 1.4 = $1,162
      ei_employee_premium: 830
      ei_employer_premium: 1162
    notes: "Employer pays 1.4x employee premium"

  # ==========================================================================
  # EI BENEFIT TESTS
  # ==========================================================================

  # Test 6: Standard EI benefit calculation
  - name: "Standard EI benefit"
    inputs:
      best_weeks_earnings: [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
      reason: job_loss
      province: ON
      regional_unemployment_rate: 0.06
    expected:
      # Average: $1,000/week
      # Benefit: 55% * $1,000 = $550/week
      ei_weekly_benefit: 550
    notes: "55% of average weekly earnings"

  # Test 7: EI benefit capped at maximum
  - name: "High earner, capped benefit"
    inputs:
      best_weeks_earnings: [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000]
      reason: job_loss
      province: ON
      regional_unemployment_rate: 0.06
    expected:
      # 55% of $2,000 = $1,100, but capped at $668
      ei_weekly_benefit: 668
    notes: "Capped at maximum weekly benefit"

  # Test 8: Variable earnings
  - name: "Variable weekly earnings"
    inputs:
      best_weeks_earnings: [800, 900, 1000, 1100, 1200, 800, 900, 1000, 1100, 1200, 1000, 1000]
      reason: job_loss
      province: ON
      regional_unemployment_rate: 0.06
    expected:
      # Average: $1,000/week
      # Benefit: 55% * $1,000 = $550/week
      ei_weekly_benefit: 550
    notes: "Best weeks averaging"

  # Test 9: Low income with Family Supplement
  - name: "Low income family, family supplement"
    inputs:
      best_weeks_earnings: [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]
      reason: job_loss
      province: ON
      family_net_income: 25921  # CCB threshold
      num_children: 2
    expected:
      # Base: 55% of $500 = $275
      # Family supplement can increase rate up to 80%
      # 80% of $500 = $400
      ei_weekly_benefit: 400
    notes: "Family supplement increases rate for low-income families with children"

  # ==========================================================================
  # ELIGIBILITY TESTS
  # ==========================================================================

  # Test 10: Hours requirement (regular benefits)
  - name: "Just enough hours for EI"
    inputs:
      insurable_hours_last_52_weeks: 700
      regional_unemployment_rate: 0.10
      reason: job_loss
    expected:
      is_ei_eligible: true
      hours_required: 700
    notes: "Hours required depends on regional unemployment rate"

  # Test 11: Not enough hours
  - name: "Insufficient hours"
    inputs:
      insurable_hours_last_52_weeks: 400
      regional_unemployment_rate: 0.06
      reason: job_loss
    expected:
      is_ei_eligible: false
    notes: "Must have 420-700 hours depending on unemployment rate"

  # Test 12: Quit without just cause
  - name: "Quit without just cause - disqualified"
    inputs:
      insurable_hours_last_52_weeks: 1000
      reason: quit_without_cause
      regional_unemployment_rate: 0.06
    expected:
      is_ei_eligible: false
    notes: "Disqualified if quit without just cause"

  # ==========================================================================
  # BENEFIT DURATION TESTS
  # ==========================================================================

  # Test 13: Benefit duration calculation
  - name: "Benefit duration"
    inputs:
      insurable_hours_last_52_weeks: 1000
      regional_unemployment_rate: 0.08
      reason: job_loss
    expected:
      # Duration based on hours and regional rate
      # 1000 hours at 8% rate = approximately 26 weeks
      ei_max_weeks: 26
    notes: "Duration varies by hours and regional unemployment"

  # Test 14: Maximum benefit duration
  - name: "Maximum benefit duration"
    inputs:
      insurable_hours_last_52_weeks: 2000
      regional_unemployment_rate: 0.15
      reason: job_loss
    expected:
      # Maximum 45 weeks
      ei_max_weeks: 45
    notes: "Cannot exceed 45 weeks regular benefits"

  # ==========================================================================
  # SPECIAL BENEFIT TESTS
  # ==========================================================================

  # Test 15: Maternity benefits
  - name: "Maternity benefits"
    inputs:
      best_weeks_earnings: [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
      reason: maternity
      insurable_hours_last_52_weeks: 600
    expected:
      ei_weekly_benefit: 550
      ei_max_weeks: 15
    notes: "Maternity: 15 weeks at 55%"

  # Test 16: Parental benefits (standard)
  - name: "Parental benefits, standard option"
    inputs:
      best_weeks_earnings: [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
      reason: parental
      parental_option: standard
      insurable_hours_last_52_weeks: 600
    expected:
      ei_weekly_benefit: 550
      ei_max_weeks: 40  # Can be shared between parents, max 35 each
    notes: "Standard parental: 40 weeks at 55% (shareable)"

  # Test 17: Parental benefits (extended)
  - name: "Parental benefits, extended option"
    inputs:
      best_weeks_earnings: [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
      reason: parental
      parental_option: extended
      insurable_hours_last_52_weeks: 600
    expected:
      # Extended: 69 weeks at 33%
      ei_weekly_benefit: 330
      ei_max_weeks: 69
    notes: "Extended parental: 69 weeks at 33% (shareable)"

  # Test 18: Sickness benefits
  - name: "Sickness benefits"
    inputs:
      best_weeks_earnings: [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
      reason: sickness
      insurable_hours_last_52_weeks: 600
    expected:
      ei_weekly_benefit: 550
      ei_max_weeks: 26
    notes: "Sickness benefits: 26 weeks (increased from 15 in 2022)"
