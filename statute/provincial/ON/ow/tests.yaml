# Ontario Works (OW) Tests
#
# Test cases for validating Ontario Works calculations.
# Uses 2024 rates.
#
# Ontario Works provides:
# - Basic needs allowance
# - Shelter allowance (actual costs up to maximum)
# - Income exemptions for employment
#
# 2024 OW Rates (monthly):
# Basic Needs:
#   - Single: $390
#   - Couple: $629
#   - Each additional dependant: Varies by age
#
# Maximum Shelter:
#   - Single: $390
#   - Couple: $642
#   - Each additional member: Additional amounts
#
# Employment Earnings Exemption: 50% (partial exemption)
#
# Reference: https://www.ontario.ca/page/ontario-works

reference: "Ontario Works Act, 1997"
year: 2024

tests:
  # ==========================================================================
  # BASIC ELIGIBILITY TESTS
  # ==========================================================================

  # Test 1: Single, no income
  - name: "Single person, no income"
    inputs:
      household_composition:
        adults: 1
        children: 0
      gross_income: 0
      shelter_costs: 500
    expected:
      # Basic needs: $390
      # Shelter: min($500, $390) = $390
      # Total: $780
      ow_basic_needs: 390
      ow_shelter: 390
      ow_total: 780
    notes: "Maximum benefit for single person"

  # Test 2: Couple, no income
  - name: "Couple, no income"
    inputs:
      household_composition:
        adults: 2
        children: 0
      gross_income: 0
      shelter_costs: 800
    expected:
      # Basic needs: $629
      # Shelter: min($800, $642) = $642
      # Total: $1,271
      ow_basic_needs: 629
      ow_shelter: 642
      ow_total: 1271
    notes: "Maximum for couple"

  # Test 3: Single parent with one child
  - name: "Single parent with one child"
    inputs:
      household_composition:
        adults: 1
        children: 1
        child_ages: [5]
      gross_income: 0
      shelter_costs: 700
    expected:
      # Basic needs: Single + child = higher amount
      # Shelter: up to family maximum
      ow_total: 1050  # Approximate - varies by child age
    notes: "Single parent family"

  # Test 4: Family with multiple children
  - name: "Couple with two children"
    inputs:
      household_composition:
        adults: 2
        children: 2
        child_ages: [8, 12]
      gross_income: 0
      shelter_costs: 1200
    expected:
      ow_total: 1600  # Approximate
    notes: "Family maximum"

  # ==========================================================================
  # INCOME TESTS
  # ==========================================================================

  # Test 5: Employment income with exemption
  - name: "Single with employment income"
    inputs:
      household_composition:
        adults: 1
        children: 0
      employment_income: 500
      shelter_costs: 400
    expected:
      # Net income: 50% of $500 = $250 counted
      # Benefit reduced by $250
      # Base: $780 - $250 = $530
      ow_total: 530
    notes: "50% earnings exemption"

  # Test 6: High employment income - partial benefit
  - name: "Working with high earnings"
    inputs:
      household_composition:
        adults: 1
        children: 0
      employment_income: 1200
      shelter_costs: 400
    expected:
      # Net income: 50% of $1,200 = $600 counted
      # Benefit: $780 - $600 = $180
      ow_total: 180
    notes: "Reduced benefit but still receiving"

  # Test 7: Income exceeds benefit - not eligible
  - name: "Income too high, not eligible"
    inputs:
      household_composition:
        adults: 1
        children: 0
      employment_income: 2000
      shelter_costs: 400
    expected:
      # Net income: 50% of $2,000 = $1,000 counted
      # Exceeds maximum $780
      ow_total: 0
    notes: "No longer eligible"

  # Test 8: Non-employment income (no exemption)
  - name: "Single with other income"
    inputs:
      household_composition:
        adults: 1
        children: 0
      other_income: 300  # E.g., support payments
      employment_income: 0
      shelter_costs: 400
    expected:
      # No exemption for other income
      # Benefit: $780 - $300 = $480
      ow_total: 480
    notes: "Non-employment income fully counted"

  # ==========================================================================
  # SHELTER TESTS
  # ==========================================================================

  # Test 9: Low shelter costs
  - name: "Low shelter costs"
    inputs:
      household_composition:
        adults: 1
        children: 0
      gross_income: 0
      shelter_costs: 200  # Below maximum
    expected:
      ow_shelter: 200  # Actual costs
      ow_total: 590
    notes: "Shelter is actual costs when below maximum"

  # Test 10: No shelter costs (living with family)
  - name: "Living with family, no shelter"
    inputs:
      household_composition:
        adults: 1
        children: 0
      gross_income: 0
      shelter_costs: 0
    expected:
      ow_shelter: 0
      ow_total: 390  # Basic needs only
    notes: "No shelter allowance if no costs"

  # ==========================================================================
  # ASSET TESTS
  # ==========================================================================

  # Test 11: Assets below limit
  - name: "Assets below limit"
    inputs:
      household_composition:
        adults: 1
        children: 0
      gross_income: 0
      shelter_costs: 400
      liquid_assets: 3000  # Below $10,000 limit
    expected:
      is_ow_asset_eligible: true
      ow_total: 780
    notes: "Single person asset limit is $10,000"

  # Test 12: Assets exceed limit
  - name: "Assets exceed limit"
    inputs:
      household_composition:
        adults: 1
        children: 0
      gross_income: 0
      shelter_costs: 400
      liquid_assets: 15000
    expected:
      is_ow_asset_eligible: false
      ow_total: 0
    notes: "Not eligible due to assets"

  # ==========================================================================
  # SPECIAL CIRCUMSTANCES
  # ==========================================================================

  # Test 13: Remote communities top-up
  - name: "Remote community supplement"
    inputs:
      household_composition:
        adults: 1
        children: 0
      gross_income: 0
      shelter_costs: 400
      is_remote_community: true
    expected:
      ow_remote_supplement: 45  # Approximate
      ow_total: 825
    notes: "Additional amount for remote areas"

  # Test 14: Pregnant woman
  - name: "Pregnant, additional nutrition"
    inputs:
      household_composition:
        adults: 1
        children: 0
      gross_income: 0
      shelter_costs: 400
      is_pregnant: true
      pregnancy_months: 5
    expected:
      ow_pregnancy_benefit: 50  # Approximate
      ow_total: 830
    notes: "Pregnancy nutrition benefit"
